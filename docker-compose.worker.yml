# docker-compose para rodar apenas o worker em máquinas remotas.
#
# O worker se comunica exclusivamente via HTTP com a API pública.
# Não requer SSH tunnel, acesso direto ao banco ou ao Redis.
#
# Uso:
#   cp .env.worker.example .env.worker
#   # editar .env.worker com a URL da API e a chave
#   docker compose -f docker-compose.worker.yml up -d

services:
  ed-worker:
    build:
      context: ../
      dockerfile: ed-infra/worker/Dockerfile
    container_name: easydoor-worker
    restart: unless-stopped
    shm_size: 2gb
    security_opt:
      - seccomp:unconfined
    cap_add:
      - SYS_ADMIN
    env_file: .env.worker
    extra_hosts:
      - "host.docker.internal:host-gateway"
